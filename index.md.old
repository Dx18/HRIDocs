# Общий ГДД

## Описание

HRI (History Repeats Itself) &mdash; игра-головоломка, действие в
которой происходит от лица робота, использующего путешествия во
времени, чтобы изучить историю погибшей от ядерной войны
цивилизации. История предполагается процедурно генерируемой.

При зарождении цивилизации робот подкидывает в начальные города и их
окрестности несколько чёрных ящиков, которые записывают всё, что
происходит вокруг них. С течением времени эти ящики "путешествуют" по
всей планете и в итоге по разным причинам оказываются уничтоженными.
Главная цель робота - собрать информацию с каждого ящика незадолго до
его уничтожения.

## Механики

Механики разбиваются на группы.

### Генерация истории

Перечисленные ниже механики связаны с процедурной генерацией истории
цивилизации, изучением которой будет заниматься игрок.

#### Генерация исходного состояния

Планета не генерируется процедурно. Она представляет собой подразбитый
икосаэдр, каждый треугольник (далее: клетка) может иметь следующий
тип:

- Пригодная для жизни суша;
- Непригодная для жизни суша;
- Вода.

Генерируется четыре страны (как можно дальше друг от друга), у каждой
страны генерируется по одному городу. Далее генерируется 10
артефактов, которые лежат в тайлах с городами или смежных с ними.

#### Строительство городов

Каждая страна может построить город. Критерии для возможности
строительства города на конкретной клетке:

- Находится на расстоянии не превышающем 3 от какого-либо
  существующего города;
- Ни на каком кратчайшем пути до существующего ближайшего города нет
  городов других стран.

Название для города генерируется случайно из набора слогов.

#### Дипломатические отношения

Каждая страна может заключить или расторгнуть договор о дружбе с
другой страной, которой не объявлена война.

#### Начало и конец войн

Каждая страна может объявить войну стране, с которой не заключено
дружественного договора. Каждая страна может прекратить войну.

#### Захват городов

Каждая страна в состоянии войны может захватить граничный город
противника. Город считается граничным, если у него существует сторона,
такая что если из неё (стороны) запустить обход в ширину, то в
клетках, достижимых из города за 3 или менее шага, нет городов
противника и стран, являющихся его друзьями.

Чёрный ящик в захваченном городе может быть уничтожен или перемещён в
другой город страны-захватчика.

#### Научные открытия

Каждая страна может совершить научное открытие. Список научных
открытий, зависимости между ними и временные затраты на исследование
предопределены.

#### Ядерная война

Происходит один раз и является последним событием для
цивилизации. Случается, когда как все цивилизации изучили ядерное
оружие, цивилизации оказались разбиты на два дружественных блока и две
цивилизации из противоположных блоков оказались в состоянии войны. При
этом выбор этого события происходит с какой-то вероятностью, то есть
даже при выполнении всех этих условий ядерная война может не произойти
(тем не менее, вероятность с каждым годом растёт).

#### Перемещение чёрного ящика

Чёрный ящик может быть перемещён из одного города в другой (той же или
дружественной страны).

#### Симуляция событий

Симуляция происходит по годам. Каждый год выбираются события исходя из
того, что на данный момент происходит в мире.

**Вопрос по поводу самого алгоритма генерации пока остаётся нерешённым.**

### Исследование мира

Механики, связанные с тем, какие действия может совершать игрок для
достижения цели.

#### Путешествие во времени

При перемещении во времени можно получить информацию о:

1. Текущих построенных городах и их принадлежности той или иной стране;
2. Текущих дипломатических отношениях;
3. Текущих войнах;
4. Текущих недавно захваченных городах (с оценкой времени, когда был
   произведён захват);
5. Текущих технологических открытиях каждой страны.

#### Посещение города

При посещении города можно получить информацию о:

1. Определённом наборе событий;
2. Определённого периода времени;
3. Определённого набора стран.

Все "определённые" наборы генерируются случайно.

Также игрок узнаёт об уничтожении чёрных ящиков в посещаемом городе и
их перемещении в другой город (при этом игрок узнаёт целевой город).

#### Чтение данных из чёрного ящика

Читать данные из чёрного ящика можно только в год его уничтожения и
только тогда, когда его местоположение известно.

### Условие выигрыша

Игра считается выигранной, если все чёрные ящики найдены и все данные
с них считаны.

### Главное меню

Механики, образующие главное меню игры.

#### Возможность начать новую игру

При наличии доступного сохранения игроку задаётся вопрос о том,
действительно ли он хочет начать новую игру. При положительном ответе
запускается алгоритм генерации истории и происходит переход на экран с
информацией о текущем прогрессе генерации.

#### Возможность загрузить сохранённую игру

Доступна только при наличии доступного сохранения. Загружается
доступное сохранение и происходит переход на главный игровой экран.

#### Возможность выйти из игры

Данная возможность доступна всегда. Подтверждения игрока не
спрашивается.

### Экран генерации истории

Экран, сопутствующий генерации истории.

#### Просмотр текущего генерируемого года

Показывается текущий год, для которого происходит генерация. Цвет
текста обозначает ожидаемую близость мира к ядерной войне (переход от
белого цвета к красному), которая вычисляется на основе сделанных
научных открытий и текущих дипломатических отношений.

### Главный игровой экран

Экран разбит на вкладки.

#### Отображение таймлайна

Игрок может просматривать таймлайн открытых событий. Также игрок имеет
возможность произвести путешествие во времени, сначала указав на
необходимый год, а затем нажав на соответствующую кнопку.

#### Отображение текущего состояния в виде планеты

Игрок может выбирать города и просматривать их текущие
характеристики. Также игрок имеет возможность посетить выбранный город
и получить новую историческую информацию.

#### Отображение текущего состояния в текстово-табличном виде

Игрок может просмотреть текущие характеристики городов, состояние
дипломатических отношений и состояние научного прогресса. Также игрок
имеет возможность посетить выбранный город и получить новую
историческую информацию.

#### Отображение информации о чёрных ящиках

Игрок может просмотреть информацию о каждом чёрном ящике (последние
известные год и локация и информация о том, наблюдалось ли его
уничтожение и были ли считаны с него данные). Ниже игроку показывается
количество считанных чёрных ящиках в виде прогресс-бара.

[Подробнее](./blackbox_info.md)

#### Возможность выйти в главное меню

У игрока спрашивается подтверждение. Затем игра сохраняется и
происходит переход в главное меню.

### Отображение таймлайна

Механики, связанные с открытой историей цивилизации.

#### Отображение дат строительства городов

На таймлайне показаны года строительства новых городов. Если в один
год было построено несколько городов, это отмечается одной точкой (с
другим обозначением). При наведении курсора показывается список
построенных городов.

#### Отображение дат дипломатических событий

На таймлайне показаны года, в которые происходили дипломатические
события (заключение и расторжение дружественных договоров). Если в
один год было несколько дипломатических событий, это отмечается одной
точкой (с другим обозначением). При наведении курсора показывается
список дипломатических событий.

#### Отображение дат объявления и окончания войн

Снизу от таймлайна показаны войны в виде отрезков. Отрезки могут быть
неполными в случае, если о граничных датах ничего не известно.

#### Отображение дат захвата городов (в рамках войн)

На таймлайне показаны года захвата городов. Если в один год было
захвачено несколько городов, это отмечается одной точкой (с другим
обозначением). При наведении курсора показывается список захваченных
городов.

#### Отображение дат технологических открытий

На таймлайне показаны года, в которые той или иной страной были
сделаны технологические открытия. Если в один год было сделано
несколько открытий, это отмечается одной точкой (с другим
обозначением). При наведении курсора показывается список сделанных
открытий.

#### Отображение даты ядерной войны

На таймлайне показан год, когда произошла ядерная война.

## Классификация по впечатлениям

**Игра-"сенсорное удовольствие":** в течение игры таймлайн будет
заполняться всё больше и больше, и игроку будет приятно на него
смотреть.

**Игра-фантазия:** благодаря процедурной генерации истории и
исследованию мира игрок может вжиться в роль исследователя
цивилизации.

**Игра-исследование:** игрок исследует историю цивилизации и узнаёт
определённые факты о ней.

**Игра-хобби:** игрок периодически заходит в игру, чтобы выяснить
дополнительные факты о цивилизации.

## Референсы

**Dwarf Fortress:** процедурная генерация мира (вместе с историей).

**Civilization, Unciv:** научные открытия и зависимости между ними,
взаимоотношения между цивилизациями.
